## Installation

```bash
npm install chess-lite
```

## Usage

### Definitions

For constant, you can use following import:

```js
import {
  INITIAL_BOARD,
  INITIAL_FEN_STATE,
  INITIAL_GAME_RESULT,
  WHITE_PIECES,
  BLACK_PIECES,
  EN_PASSANT_PIECES,
} from "chess-lite/definitions";
```

For types you can use folowing definitions:

```js
import {
  type Board,
  type BoardValue,
  type FenState,
  type EnPassantTargetSquareMove,
  type CastleAbility,
  type GameState,
  type Move,
  type Player,
  type Square,
  type GameResult,
} from "chess-lite/definitions";
```

To see more about types and constants, you can check out the [github](https://github.com/dvenomb98/artic-frost/tree/main/packages/chess-lite).

### Fen

Fen is a string that represents the board state. This module provides a utilites to parse and generate fen strings.

```js
import { INITIAL_FEN_POSITION } from "chess-lite/fen";
//  Output: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"

import { parseFen, generateFen } from "chess-lite/fen";

// Parse FEN string to FenState object
const fenState = parseFen(INITIAL_FEN_POSITION);
// Output:
// {
//   board: [
//     ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
//     ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
//     ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
//   ],
//   onTurn: "WHITE",
//   castleAbility: {
//     WHITE: { short: true, long: true },
//     BLACK: { short: true, long: true }
//   },
//   enPassantTargetSquare: null,
//   halfMoves: 0,
//   fullMoves: 1
// }

// Generate FEN string from FenState object
const generatedFen = generateFen(fenState);
// Output: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"
```

### Api

The core module provides a set of functions to manipulate the game state.

```tsx
import { getValidatedMoves, move, getGameResult } from "chess-lite/api";

// Get validated moves for a given square
const validatedMoves = getValidatedMoves(fenState, square);
// Output:
// [
//   {
//     rowIndex: 1,
//     colIndex: 0,
//     piece: 'P',
//     prevRowIndex: 2,
//     prevColIndex: 0,
//     isCastle: false,
//     isEnPassant: false
//   }
// ]

// Move a piece on the board
// IMPORTANT:
// This does not validate the move, it just moves the piece on the board and return the new state
const nextState = move(fenState, move);
// Output:
// {
//   board: [
//     ['r', 'n', 'b', 'q', 'k', 'b', 'n', 'r'],
//     ['p', 'p', 'p', 'p', 'p', 'p', 'p', 'p'],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     [null, null, null, null, null, null, null, null],
//     ['P', 'P', 'P', 'P', 'P', 'P', 'P', 'P'],
//     ['R', 'N', 'B', 'Q', 'K', 'B', 'N', 'R']
//   ],
//   castleAbility: {
//     WHITE: { short: true, long: true },
//     BLACK: { short: true, long: true }
//   },
//   enPassantTargetSquare: null,
//   onTurn: "BLACK",
//   fullMoves: 1,
//   halfMoves: 0
// }

// Get game result
const result = getGameResult(fenState);
// Output:
// {
//    gameState: "CHECKMATE"
//    winner: "BLACK"
// }
```

## Example application

This code example demonstrate how intergrate api module to perform one round of player onTurn

```tsx
import { getValidatedMoves, move, getGameResult } from "chess-lite/api";

import { type FenState, type Square } from "chess-lite/definitions";

// 1. User click on a square
// We validate all possible moves for that square and show them to user

function squareClick(fenState: FenState, square: Square) {
  const possibleMoves = getValidatedMoves(fenState, square);
  return {
    ...fenState,
    possibleMoves,
  };
}

// User click on a possible move to peform move action
function moveAction(fenState: FenState, move: Move) {
  const nextFenState = move(fenState, move);
  // Validate the newly created state to check if the game is still on going
  // or it is ended by checkmate or draw.
  const result = getGameResult(nextFenState);
  return {
    ...nextFenState,
    ...result,
  };
}
```

#### Want to check out a full multiplayer game example using nextjs, supabase and chess-lite?

Implementation of the library to run a multiplayer game can be found [here](https://github.com/dvenomb98/artic-frost/blob/main/apps/chess/src/features/chess).

If you want to try it out, you can go to [this website](https://chess.danielbilek.com) and play a game. It is free.
